{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}{{ title }} | GidiNest Admin{% endblock %}

{% block extrastyle %}
<style>
    .dashboard-container { padding: 20px; }
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    .stat-card {
        background: white;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .stat-card h3 {
        margin: 0 0 10px 0;
        font-size: 14px;
        color: #666;
        font-weight: 500;
        text-transform: uppercase;
    }
    .stat-card .number {
        font-size: 32px;
        font-weight: 700;
        color: #333;
        margin: 10px 0;
    }
    .stat-card.primary { border-left: 4px solid #417690; }
    .stat-card.success { border-left: 4px solid #28a745; }
    .stat-card.warning { border-left: 4px solid #ffc107; }
    .stat-card.danger { border-left: 4px solid #dc3545; }
    .alert {
        padding: 15px 20px;
        margin-bottom: 15px;
        border-radius: 6px;
        border-left: 4px solid;
    }
    .alert-danger { background-color: #f8d7da; border-color: #dc3545; color: #721c24; }
    .alert-warning { background-color: #fff3cd; border-color: #ffc107; color: #856404; }
</style>
{% endblock %}

{% block content %}
<div class="dashboard-container">
    <h1>üéØ {{ title }}</h1>
    <p>Real-time customer support metrics and system health</p>

    {% if alerts %}
    <div style="margin: 20px 0;">
        <h2>‚ö†Ô∏è Alerts</h2>
        {% for alert in alerts %}
        <div class="alert alert-{{ alert.type }}">
            <strong>{{ alert.message }}</strong>
            {% if alert.link %}<a href="{{ alert.link }}" style="margin-left: 15px;">View ‚Üí</a>{% endif %}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <h2>üë• User Metrics</h2>
    <div class="stats-grid">
        <div class="stat-card primary">
            <h3>Total Users</h3>
            <div class="number">{{ total_users|default:0 }}</div>
        </div>
        <div class="stat-card success">
            <h3>Active Users</h3>
            <div class="number">{{ active_users|default:0 }}</div>
        </div>
        <div class="stat-card warning">
            <h3>Unverified</h3>
            <div class="number">{{ unverified_users|default:0 }}</div>
        </div>
    </div>

    <h2>üí∞ Wallet & Transactions</h2>
    <div class="stats-grid">
        <div class="stat-card primary">
            <h3>Total Balance</h3>
            <div class="number">‚Ç¶{{ total_balance|floatformat:2|default:"0.00" }}</div>
        </div>
        <div class="stat-card warning">
            <h3>Pending Withdrawals</h3>
            <div class="number">{{ pending_withdrawals|default:0 }}</div>
        </div>
        <div class="stat-card danger">
            <h3>Failed (24h)</h3>
            <div class="number">{{ failed_withdrawals_24h|default:0 }}</div>
        </div>
    </div>

    <h2>üéß Support Tickets</h2>
    <div class="stats-grid">
        <div class="stat-card warning">
            <h3>Open Notes</h3>
            <div class="number">{{ open_notes|default:0 }}</div>
        </div>
        <div class="stat-card danger">
            <h3>Urgent</h3>
            <div class="number">{{ urgent_notes|default:0 }}</div>
        </div>
        <div class="stat-card success">
            <h3>Resolved (24h)</h3>
            <div class="number">{{ notes_resolved_24h|default:0 }}</div>
        </div>
    </div>

    <h2>üñ•Ô∏è System Health</h2>
    <div class="stats-grid">
        <div class="stat-card {% if errors_24h > 50 %}danger{% else %}warning{% endif %}">
            <h3>Errors (24h)</h3>
            <div class="number">{{ errors_24h|default:0 }}</div>
        </div>
    </div>
</div>
{% endblock %}
